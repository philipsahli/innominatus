apiVersion: score.dev/v1b1
metadata:
  name: world-app3

containers:
  main:
    image: nginx:1.21
    variables:
      SERVER_NAME: ${resources.hostname.value}
      DATABASE_URL: postgresql://${resources.db.username}:${resources.db.password}@${resources.db.host}:${resources.db.port}/${resources.db.name}

resources:
  hostname:
    type: route
    properties:
      value: "web.example.com"
      port: 80

  db:
    type: postgres
    properties:
      host: "postgres-service"
      port: 5432
      name: "webdb"
      username: "webuser"
      password: "secretpass"

  storage:
    type: volume
    properties:
      size: "2Gi"
      mountPath: "/var/www/html"

environment:
  type: development
  ttl: 24h

#workflows:
#  deploy:
#    steps:
#      - name: provision-infra
#        type: terraform
#        path: ./terraform/infra
#      - name: deploy-app
#        type: kubernetes
#        namespace: web-service-dev  # Custom namespace
#      - name: configure-app
#        type: ansible
#        playbook: ./ansible/post-deploy.yml
