# innominatus Environment Configuration
#
# Copy this file to .env and configure for your environment:
#   cp .env.example .env
#
# Then load it before running the server:
#   export $(cat .env | xargs) && ./innominatus
#

# ============================================================
# Server Configuration
# ============================================================

# Server host and port
SERVER_HOST=0.0.0.0
SERVER_PORT=8081

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Environment: development, staging, production
ENVIRONMENT=development

# ============================================================
# Database Configuration (PostgreSQL)
# ============================================================

# Database connection details
DB_HOST=localhost
DB_PORT=5432
DB_NAME=idp_orchestrator
DB_USER=orchestrator_user
DB_PASSWORD=your_secure_password_here

# Database SSL mode: disable, require, verify-ca, verify-full
DB_SSLMODE=disable

# Connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# ============================================================
# Authentication Configuration
# ============================================================

# API Key for CLI and API access
# Generate a secure random key: openssl rand -hex 32
IDP_API_KEY=your_api_key_here

# OIDC Authentication (Enterprise SSO)
# Enable OIDC authentication
OIDC_ENABLED=false

# OIDC Provider Configuration
# Example for Keycloak:
OIDC_ISSUER=http://keycloak.localtest.me/realms/demo-realm
OIDC_CLIENT_ID=innominatus-web
OIDC_CLIENT_SECRET=innominatus-client-secret
OIDC_REDIRECT_URL=http://localhost:8081/auth/oidc/callback

# Example for Azure AD:
# OIDC_ISSUER=https://login.microsoftonline.com/{tenant-id}/v2.0
# OIDC_CLIENT_ID=your-azure-app-client-id
# OIDC_CLIENT_SECRET=your-azure-app-client-secret
# OIDC_REDIRECT_URL=https://innominatus.yourcompany.com/auth/oidc/callback

# Example for Okta:
# OIDC_ISSUER=https://your-domain.okta.com/oauth2/default
# OIDC_CLIENT_ID=your-okta-client-id
# OIDC_CLIENT_SECRET=your-okta-client-secret
# OIDC_REDIRECT_URL=https://innominatus.yourcompany.com/auth/oidc/callback

# ============================================================
# Workflow Execution Configuration
# ============================================================

# Workspace directory for workflow execution
WORKSPACE_DIR=./workspace

# Timeout for workflow steps (in minutes)
WORKFLOW_STEP_TIMEOUT=30

# Maximum concurrent workflow executions
MAX_CONCURRENT_WORKFLOWS=5

# ============================================================
# Observability Configuration
# ============================================================

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PATH=/metrics

# OpenTelemetry Tracing
OTEL_ENABLED=false
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_SERVICE_NAME=innominatus
OTEL_TRACE_SAMPLE_RATE=1.0

# Structured Logging
LOG_FORMAT=json  # json or console
LOG_OUTPUT=stdout  # stdout or file path

# ============================================================
# Kubernetes Configuration (for demo-time)
# ============================================================

# Kubernetes context (for demo environment)
KUBE_CONTEXT=docker-desktop

# Kubernetes namespace for demo components
DEMO_NAMESPACE=innominatus-demo

# ============================================================
# External Service Configuration
# ============================================================

# Terraform Configuration
TERRAFORM_VERSION=1.5.0
TERRAFORM_BINARY=/usr/local/bin/terraform

# Ansible Configuration
ANSIBLE_VERSION=2.15.0
ANSIBLE_BINARY=/usr/local/bin/ansible-playbook

# Kubectl Configuration
KUBECTL_BINARY=/usr/local/bin/kubectl

# Helm Configuration
HELM_BINARY=/usr/local/bin/helm

# ============================================================
# Feature Flags
# ============================================================

# Enable experimental features
ENABLE_EXPERIMENTAL_FEATURES=false

# Enable graph visualization WebSocket
ENABLE_GRAPH_WEBSOCKET=true

# Enable critical path analysis
ENABLE_CRITICAL_PATH=true

# Enable performance metrics
ENABLE_PERFORMANCE_METRICS=true

# Enable annotations
ENABLE_ANNOTATIONS=true

# ============================================================
# Security Configuration
# ============================================================

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8081

# Rate limiting (requests per minute per IP)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100

# Session configuration
SESSION_SECRET=your_session_secret_here_change_in_production
SESSION_MAX_AGE=86400  # 24 hours in seconds

# ============================================================
# Development & Testing
# ============================================================

# Enable debug mode (more verbose logging, detailed errors)
DEBUG=false

# Enable profiling endpoints
ENABLE_PROFILING=false

# Mock external services (for testing)
MOCK_TERRAFORM=false
MOCK_ANSIBLE=false
MOCK_KUBECTL=false

# Test database (for integration tests)
TEST_DB_HOST=localhost
TEST_DB_PORT=5432
TEST_DB_NAME=idp_orchestrator_test
TEST_DB_USER=test_user
TEST_DB_PASSWORD=test_password

# ============================================================
# Admin Configuration
# ============================================================

# Path to admin configuration file
ADMIN_CONFIG_PATH=./admin-config.yaml

# Path to golden paths configuration
GOLDEN_PATHS_CONFIG=./goldenpaths.yaml

# Path to users file (for file-based authentication)
USERS_FILE=./users.yaml

# ============================================================
# Backup & Migration
# ============================================================

# Database backup directory
BACKUP_DIR=./backups

# Enable automatic backups
AUTO_BACKUP_ENABLED=false
AUTO_BACKUP_INTERVAL=24h  # 24 hours

# Database migration directory
MIGRATIONS_DIR=./migrations

# ============================================================
# Notifications (Optional)
# ============================================================

# Slack webhook for workflow notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Email notifications
SMTP_HOST=smtp.yourcompany.com
SMTP_PORT=587
SMTP_USER=notifications@yourcompany.com
SMTP_PASSWORD=your_smtp_password
SMTP_FROM=innominatus@yourcompany.com

# ============================================================
# Cloud Provider Credentials (for Terraform)
# ============================================================

# AWS Credentials
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-east-1

# Azure Credentials
AZURE_SUBSCRIPTION_ID=your_subscription_id
AZURE_CLIENT_ID=your_client_id
AZURE_CLIENT_SECRET=your_client_secret
AZURE_TENANT_ID=your_tenant_id

# GCP Credentials
GOOGLE_CLOUD_PROJECT=your-gcp-project
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json

# ============================================================
# Minio/S3 Configuration (for demo)
# ============================================================

# Minio endpoint (for demo environment)
MINIO_ENDPOINT=http://minio.minio-system.svc.cluster.local:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=innominatus-artifacts

# ============================================================
# Notes
# ============================================================

# 1. Never commit .env file to version control
# 2. Use strong, unique passwords for production
# 3. Rotate API keys and secrets regularly
# 4. Use environment-specific .env files (.env.dev, .env.prod)
# 5. Consider using secret management tools (Vault, AWS Secrets Manager)
